local function longestRepeatedSubstring(str)
    local n = #str
    local LCSRe = {}
    for i = 1, n + 1 do
        LCSRe[i] = {}
    end

    local res = ""
    local res_length = 0

    local index = 0
    for i = 1, n do
        for j = i + 1, n do
            if (str:sub(i - 1, i - 1) == str:sub(j - 1, j - 1)
                and LCSRe[i - 1][j - 1] < (j - i)) then
                LCSRe[i][j] = LCSRe[i - 1][j - 1] + 1;

                if (LCSRe[i][j] > res_length) then
                    res_length = LCSRe[i][j];
                    index = math.max(i, index);
                end
            else
                LCSRe[i][j] = 0;
            end
        end
    end

    if (res_length > 0) then
        for i = index - res_length + 1, index do
            res = res .. str:sub(i - 1, i - 1)
        end
    end

    return res;
end

-- Driver program to test the above function

local sequence = { 1, 3, 2, 1, 2, 1, 3, 2, 2, 0, 1, 3, 2, 0, 2, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4,
    0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1,
    2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2,
    1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1,
    3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0,
    1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4,
    0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3,
    0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3,
    2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0,
    2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0,
    1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2,
    0, 1, 2, 1, 2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1,
    2, 0, 1, 3, 2, 0, 0, 1, 3, 3, 4, 0, 1, 2, 3, 0, 1, 1, 3, 2, 2, 0, 0, 2, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 0, 1, 3,
    2, 0, 0, 1, 3, 3, 4 }

print(table.concat(sequence))
--print(longestRepeatedSubstring(table.concat(sequence)))
--print(longestRepeatedSubstring("13212132201320213340123011322002340121201212013200133401230113220023401212012120132001334012301132200234012120121201320013340123011322002340121201212013200133401230113220023401212012120132001334012301132200234012120121201320013340123011322002340121201212013200133401230113220023401212012120132001334012301132200234012120121201320013340123011322002340121201212013200133401230113220023401212012120132001334012301132200234012120121201320013340123011322002340121201212013200133401230113220023401212012120132001334"))

local str = "1330213042003010332213300122201230213020133401213013200130001320013240132221332013302133201332013300121201332013322132201332013300022201230012220130021212013212122001304002300133001332213320133200222013320122400032013220122111330013300113001213200320132401212002020132201032212122003001321003340132001334013000133220320013220103221332013032030320032013220022201234013222000401230003300132201332012300130200303012320132001234212122003020030212320133021032002302133001234212220033000222012211132201324002340130321330211300132001230011300103121300212300133401014212132132201212013300133221334013030030300324000122130320234000312030021321013300133001214013300133201302012122122021222013011033021230013320133221224013342121001320013202133000222013022130021301110322123001220013300133001234013322133001320203202121221322002300130220232213322103111330013002132201322012120122201230013320122201322202340020001332010312030300234213200132221322202322122111332012300122221032012222030011230202130012201330013322132221322212322133000232013300123201330013320101221332013340130201330013320022421004213320133201330013340003001300013222112121213003300132001211113300133201320012122003121332013302130220031112212012201230013340133221330013202130401320113320121421330000322130301321213322133221332213010133001232003222133001332013012121221230212120133401334000120122020230013030013201320213320132201322013222123001321213240002201322012122132401222212220123401222012342133001320013300022201330012220133201322012240121301332013322123010330013322133400031210011030201324212300133420300110020133201330213201132201324013032133200301013220132001321003240132201324013242123201332013212030021222013222030320010013210033001330002322133001304013300"
-- length = 1720
local mesuredHeight = 0
for i = 1, #str do
    mesuredHeight = mesuredHeight + tonumber(str:sub(i, i))
end
print("height of motif", mesuredHeight) -- 2626
-- index 186



str = "13032133401212002322133021332213340132111220012222133021230113240122221332213240001021234210002023001332002222003400030003040130401334013320021300232213302130101332013220130401302200222" -- prefix
mesuredHeight = 0
for i = 1, #str do
    mesuredHeight = mesuredHeight + tonumber(str:sub(i, i))
end
print("height of prefix", mesuredHeight) -- 297


print("nb occurences", math.floor((1000000000000 - 185) / 1720)) -- 581395348 occurences

local resteLength = 1000000000000 - 185 - 581395348*1720
print("Reste length", resteLength)
str = "1330213042003010332213300122201230213020133401213013200130001320013240132221332013302133201332013300121201332013322132201332013300022201230012220130021212013212122001304002300133001332213320133200222013320122400032013220122111330013300113001213200320132401212002020132201032212122003001321003340132001334013000133220320013220103221332013032030320032013220022201234013222000401230003300132201332012300130200303012320132001234212122003020030212320133021032002302133001234212220033000222012211132201324002340130321330211300132001230011300103121300212300133401014212132132201212013300133221334013030030300324000122130320234000312030021321013300133001214013300133201302012122122021222013011033021230013320133221224013342121001320013202133000222013022130021301110322123001220013300133001234013322133001320203202121221322002300130220232213322103111330013002132201322012120122201230013320122201322202340020001332010312030300234213200132221322202322122111332012300122221032012222030011230202130012201330013322132221322212322133000232013300123201330013320101221332013340130201330013320022421004213320133201330013340003001300013222112121213003300132001211113300133201320012122003121332013302130220031112212012201230013340133221330013202130401320113320121421330000322130301321213322133221332213010133001232003222133001332013012121221230212120133401334000120122020230013030013201320213320132201322013222123001321213240002201322012122132401222212220123401222012342133001320013300022201330012220133201322012240121301332013322123010330013322133400031210011030201324212300133420300110020133201330213201132201324013032133200301013220132001321003240132201324013242123201332013212030021222013222030320010013210033001330002322133001304013300" -- prefix
mesuredHeight = 0
for i = 1, 1255 do
    mesuredHeight = mesuredHeight + tonumber(str:sub(i, i))
end

print("Height of suffix", mesuredHeight)
print(297 + 581395348*2626 + 1897)